import{c as F,w as L,d as b,i as m,a as l,F as j,I as E,E as V,h as A,t as _,W as B,X as I,u as P,j as M,s as Q,k as R}from"./index-012dff6d.js";import{C as W}from"./Collapase-e2e3c245.js";import{O as X}from"./Option-5b9f40bb.js";import{V as G}from"./Value-32b1f0db.js";import{c as H}from"./createField-0624a138.js";const J=_("<div>"),K=_('<div class="cm-select-options"><ul class="cm-select-option-list">'),N=_('<div class="cm-select-options-wrap">');function ee(t){const[u,d]=F(!1),O=t.align??"bottomLeft",[f,C]=H(t,""),[$,w]=F(""),x=()=>R(t,"cm-select","cm-autocomplete",{"cm-select-disabled":t.disabled,[`cm-select-${t.size}`]:t.size,"cm-select-clearable":!t.disabled&&t.clearable&&f().length!==0,"cm-select-open":u(),"cm-select-with-prefix":t.prefix});let y;const g="label",r=t.valueField||"value";let h=!1,s=[];t.data&&(s=t.data.map(e=>typeof e=="object"?(e._show=!0,e):{[r]:e,label:e,_show:!0}));const[c,k]=L({list:s});b(()=>{const e=f();k("list",n=>n,B(n=>{n._checked=e===n[r]}))}),b(()=>{t.data&&(s=t.data.map(e=>typeof e=="object"?(e._show=!0,e):{[r]:e,label:e,_show:!0}),k("list",()=>[...s]),s.length&&d(!0))}),b(()=>{const e=$();h||e.length&&t.onSearch&&t.onSearch(e)});const D=(e,n)=>{C(e),h=!0,w(n[g]),queueMicrotask(()=>{h=!1}),t.onChange&&t.onChange(e,n),d(!1)},S=()=>{const e=f();let n;return I(()=>{n=c.list.find(a=>a[r]===e)}),n?n[g]:t.emptyOption?t.emptyOption:""},q=e=>{e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),t.onChange&&t.onChange(""),C("")},z=()=>!!(c.list&&c.list.length);return(()=>{const e=J(),n=y;return typeof n=="function"?P(n,e):y=e,m(e,l(V,{get transfer(){return t.transfer},align:O,get disabled(){return t.disabled},trigger:"click",visible:[u,d],onBeforeDrop:z,get menu(){return(()=>{const a=N();return m(a,l(W,{get open(){return u()},get children(){const i=K(),v=i.firstChild;return m(v,l(j,{get each(){return c.list},children:o=>l(X,{get renderOption(){return t.renderOption},get visible(){return o._show},get disabled(){return o.disabled},data:o,get checked(){return o._checked},valueField:r,textField:g,onClick:D})})),i}})),a})()},get children(){return l(G,{get text(){return S()},get disabled(){return t.disabled},filter:!0,query:[$,w],get clearable(){return t.clearable},onClear:q,get placeholder(){return t.placeholder},get prepend(){return t.prefix},get size(){return t.size},get icon(){return l(E,{name:"chevron-down",class:"cm-select-cert"})}})}})),A(a=>{const i=x(),v=t.style;return a._v$=M(e,i,a._v$),a._v$2=Q(e,v,a._v$2),a},{_v$:void 0,_v$2:void 0}),e})()}export{ee as A};
