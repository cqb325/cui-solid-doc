import{i as w,f as x,h as I,t as y,j as p,s as H,k as B,e as R,E as Q,d as L,w as W,L as M,N as z,O as G,Q as O,a as J,x as E,F as K}from"./index-5e251d81.js";const V=y('<div><div class="cm-card-body">'),X=y('<div class="cm-card-head">'),Y=y('<div class="cm-card-footer">');function re(o){const $=()=>B(o,"cm-card",{"cm-card-bordered":o.bordered,"cm-card-rised":o.rised});return(()=>{const d=V(),k=d.firstChild;return w(d,(()=>{const r=x(()=>!!o.title);return()=>r()?(()=>{const i=X();return w(i,()=>o.title),i})():null})(),k),w(k,()=>o.children),w(d,(()=>{const r=x(()=>!!o.footer);return()=>r()?(()=>{const i=Y();return w(i,()=>o.footer),i})():null})(),null),I(r=>{const i=$(),f=o.style,u=o.bodyStyle;return r._v$=p(d,i,r._v$),r._v$2=H(d,f,r._v$2),r._v$3=H(k,u,r._v$3),r},{_v$:void 0,_v$2:void 0,_v$3:void 0}),d})()}function Z(o,$=0,d,k=500,r){window.requestAnimationFrame||(window.requestAnimationFrame=function(h){return window.setTimeout(h,1e3/60)});const i=Math.abs($-d),f=Math.ceil(i/k*50);function u(h,v,a){if(h===v){r&&r();return}let _=h+a>v?v:h+a;h>v&&(_=h-a<v?v:h-a),o===window?window.scrollTo(_,_):o.scrollTop=_,window.requestAnimationFrame(()=>u(_,v,a))}u($,d,f)}function ee(o){const $=R(()=>o.children),d=()=>$.toArray();return o.subItems=d,o}const te=y('<div class="cm-anchor-link"><a class="cm-anchor-link-title">'),ne=y('<div><div class="cm-anchor-wrapper"><div class="cm-anchor-inner"><div><span class="cm-anchor-ink-ball">');function oe(o){const $=()=>B(o,"cm-anchor"),d=R(()=>o.children),k=()=>d.toArray(),[r,i]=Q({inkTop:0,inkHeight:0,currentId:"",currentLink:"",animating:!1,links:[],upperFirstTitle:!0});L(()=>{i("links",k())}),L(()=>{o.onChange?.(r.currentId)});let f=null,u=null,h=0;const v=o.bounds||5;let a=[];const _=o.mode??"hash",D=o.showInk??!1,A=()=>{let t;if(_==="hash"){const e=window.location.href;t=/#([^#]+)$/.exec(e)}else{const e=window.location.href,c=e.includes("?")?e.split("?")[1]:"",n=new URLSearchParams(c);n.has("_to")&&n.get("_to")&&(t=[],t[0]=n.get("_to"),t[1]=n.get("_to")?.replace("#",""))}if(!t){setTimeout(()=>{const e=document.documentElement.scrollTop||document.body.scrollTop;F(e)},10);return}i("currentLink",t[0]),i("currentId",t[1])},b=()=>{f&&f.removeEventListener("scroll",C),window.removeEventListener("hashchange",A)},C=t=>{if(r.animating)return;const e=document.documentElement.scrollTop||document.body.scrollTop||t.target.scrollTop;F(e)},S=()=>{const t=document.getElementById(r.currentId),e=document.querySelector(`a[data-href="${r.currentLink}"]`);let c=o.scrollOffset||0;if(e&&(c=parseFloat(e.getAttribute("data-scroll-offset"))),!t)return;const n=t.offsetTop-h-c;i("animating",!0),Z(f,u.scrollTop,n,600,()=>{i("animating",!1)})};L(()=>{r.currentLink;const t=document.querySelector(`a[data-href="${r.currentLink}"]`)?.parentElement;if(!t)return;const e=t.offsetTop,c=t.getBoundingClientRect().height,n=c/4,s=e<0?o.offsetTop||0:e;O(()=>{i("inkTop",s+n/2),i("inkHeight",c*3/4)})});const P=()=>{f=o.container?typeof o.container=="string"?document.querySelector(o.container):o.container:window,u=o.container?f:document.documentElement||document.body},F=t=>{let e=-1;const c=a.length;let n={link:"#",offset:0};for(t+=v;++e<c;){const s=a[e],l=a[e+1];if(t>=s.offset&&t<(l&&l.offset||1/0)){n=a[e];break}}i("currentLink",n.link)},N=()=>f===window,U=()=>{A(),setTimeout(()=>{b(),P(),h=N()?0:u.offsetTop,S(),f.addEventListener("scroll",C),window.addEventListener("hashchange",A)},0)};L(()=>{const t=r.links.map(e=>e.href);O(()=>{const e=t.map(n=>n.split("#")[1]);u||P();const c=[];e.forEach(n=>{const s=document.getElementById(n);s&&c.push({link:`#${n}`,offset:s.offsetTop-u.offsetTop})}),a=c})});const j=(t,e)=>{if(e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),i("currentLink",t),i("currentId",t.replace("#","")),S(),_==="hash")window.location.hash=t;else{const c=window.location.href,n=c.includes("?")?c.split("?")[1]:"",s=location.hash.indexOf("?"),l=s>-1?location.hash.substring(0,s):location.hash,m=new URLSearchParams(n);m.set("_to",t),window.history.replaceState({},"",`${location.pathname}${l}?${m.toString()}`)}};W(()=>{U();const t=setInterval(()=>{r.links.map(n=>n.href).map(n=>n.split("#")[1]).forEach((n,s)=>{const l=document.getElementById(n);if(l){const m=l.offsetTop-u.offsetTop;a[s]&&a[s].offset!==m&&(a[s].offset=m)}})},500);M(()=>{clearInterval(t)})}),M(()=>{b()});const q=t=>t&&t.length?J(K,{each:t,children:e=>(()=>{const c=te(),n=c.firstChild;return n.$$click=s=>{j(e.href,s)},w(n,()=>e.title),w(c,()=>q(e.subItems()),null),I(s=>{const l=e.href,m=o.scrollOffset||0,g=e.href,T=e.title;return l!==s._v$&&E(n,"href",s._v$=l),m!==s._v$2&&E(n,"data-scroll-offset",s._v$2=m),g!==s._v$3&&E(n,"data-href",s._v$3=g),T!==s._v$4&&E(n,"title",s._v$4=T),s},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),c})()}):null;return(()=>{const t=ne(),e=t.firstChild,c=e.firstChild,n=c.firstChild,s=n.firstChild;return z(n,"cm-anchor-ink "+(D?"cm-anchor-show":"")),w(c,()=>q(r.links),null),I(l=>{const m=$(),g=`${r.inkTop}px`,T=`${r.inkHeight}px`;return l._v$5=p(t,m,l._v$5),g!==l._v$6&&((l._v$6=g)!=null?s.style.setProperty("top",g):s.style.removeProperty("top")),T!==l._v$7&&((l._v$7=T)!=null?s.style.setProperty("height",T):s.style.removeProperty("height")),l},{_v$5:void 0,_v$6:void 0,_v$7:void 0}),t})()}oe.Link=ee;G(["click"]);export{oe as A,re as C,Z as s};
