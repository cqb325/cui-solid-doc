import{i as w,f as q,h as I,t as y,j as B,s as x,k as O,e as R,w as W,d as A,L as X,x as H,y as z,p as G,X as M,a as J,D as L,F as K}from"./index-012dff6d.js";const Q=y('<div><div class="cm-card-body">'),V=y('<div class="cm-card-head">'),Y=y('<div class="cm-card-footer">');function se(o){const $=()=>O(o,"cm-card",{"cm-card-bordered":o.bordered,"cm-card-rised":o.rised});return(()=>{const d=Q(),k=d.firstChild;return w(d,(()=>{const s=q(()=>!!o.title);return()=>s()?(()=>{const c=V();return w(c,()=>o.title),c})():null})(),k),w(k,()=>o.children),w(d,(()=>{const s=q(()=>!!o.footer);return()=>s()?(()=>{const c=Y();return w(c,()=>o.footer),c})():null})(),null),I(s=>{const c=$(),f=o.style,u=o.bodyStyle;return s._v$=B(d,c,s._v$),s._v$2=x(d,f,s._v$2),s._v$3=x(k,u,s._v$3),s},{_v$:void 0,_v$2:void 0,_v$3:void 0}),d})()}function Z(o,$=0,d,k=500,s){window.requestAnimationFrame||(window.requestAnimationFrame=function(h){return window.setTimeout(h,1e3/60)});const c=Math.abs($-d),f=Math.ceil(c/k*50);function u(h,v,a){if(h===v){s&&s();return}let _=h+a>v?v:h+a;h>v&&(_=h-a<v?v:h-a),o===window?window.scrollTo(_,_):o.scrollTop=_,window.requestAnimationFrame(()=>u(_,v,a))}u($,d,f)}function ee(o){const $=R(()=>o.children),d=()=>$.toArray();return o.subItems=d,o}const te=y('<div class="cm-anchor-link"><a class="cm-anchor-link-title">'),ne=y('<div><div class="cm-anchor-wrapper"><div class="cm-anchor-inner"><div><span class="cm-anchor-ink-ball">');function oe(o){const $=()=>O(o,"cm-anchor"),d=R(()=>o.children),k=()=>d.toArray(),[s,c]=W({inkTop:0,inkHeight:0,currentId:"",currentLink:"",animating:!1,links:[],upperFirstTitle:!0});A(()=>{c("links",k())});let f=null,u=null,h=0,v=o.bounds||5,a=[],_=o.mode??"hash",D=o.showInk??!1;const E=()=>{let t;if(_==="hash"){const e=window.location.href;t=/#([^#]+)$/.exec(e)}else{let e=window.location.href;const l=e.includes("?")?e.split("?")[1]:"",n=new URLSearchParams(l);n.has("_to")&&n.get("_to")&&(t=[],t[0]=n.get("_to"),t[1]=n.get("_to")?.replace("#",""))}if(!t){setTimeout(()=>{const e=document.documentElement.scrollTop||document.body.scrollTop;p(e)},10);return}c("currentLink",t[0]),c("currentId",t[1])},b=()=>{f&&f.removeEventListener("scroll",C),window.removeEventListener("hashchange",E)},C=t=>{if(s.animating)return;const e=document.documentElement.scrollTop||document.body.scrollTop||t.target.scrollTop;p(e)},S=()=>{const t=document.getElementById(s.currentId),e=document.querySelector(`a[data-href="${s.currentLink}"]`);let l=o.scrollOffset||0;if(e&&(l=parseFloat(e.getAttribute("data-scroll-offset"))),!t)return;const n=t.offsetTop-h-l;c("animating",!0),Z(f,u.scrollTop,n,600,()=>{c("animating",!1)})};A(()=>{s.currentLink;const t=document.querySelector(`a[data-href="${s.currentLink}"]`)?.parentElement;if(!t)return;const e=t.offsetTop,l=t.getBoundingClientRect().height,n=l/4,r=e<0?o.offsetTop||0:e;M(()=>{c("inkTop",r+n/2),c("inkHeight",l*3/4)})});const P=()=>{f=o.container?typeof o.container=="string"?document.querySelector(o.container):o.container:window,u=o.container?f:document.documentElement||document.body},p=t=>{let e=-1,l=a.length,n={link:"#",offset:0};for(t+=v;++e<l;){let r=a[e],i=a[e+1];if(t>=r.offset&&t<(i&&i.offset||1/0)){n=a[e];break}}c("currentLink",n.link)},U=()=>f===window,j=()=>{E(),setTimeout(()=>{b(),P(),h=U()?0:u.offsetTop,S(),f.addEventListener("scroll",C),window.addEventListener("hashchange",E)},0)};A(()=>{const t=s.links.map(e=>e.href);M(()=>{const e=t.map(n=>n.split("#")[1]);u||P();const l=[];e.forEach(n=>{const r=document.getElementById(n);r&&l.push({link:`#${n}`,offset:r.offsetTop-u.offsetTop})}),a=l})});const N=(t,e)=>{if(e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),c("currentLink",t),c("currentId",t.replace("#","")),S(),_==="hash")window.location.hash=t;else{let l=window.location.href;const n=l.includes("?")?l.split("?")[1]:"",r=location.hash.indexOf("?"),i=r>-1?location.hash.substring(0,r):location.hash,m=new URLSearchParams(n);m.set("_to",t),window.history.replaceState({},"",`${location.pathname}${i}?${m.toString()}`)}};X(()=>{j();let t=setInterval(()=>{s.links.map(n=>n.href).map(n=>n.split("#")[1]).forEach((n,r)=>{const i=document.getElementById(n);if(i){const m=i.offsetTop-u.offsetTop;a[r]&&a[r].offset!==m&&(a[r].offset=m)}})},500);H(()=>{clearInterval(t)})}),H(()=>{b()});const F=t=>t&&t.length?J(K,{each:t,children:e=>(()=>{const l=te(),n=l.firstChild;return n.$$click=r=>{N(e.href,r)},w(n,()=>e.title),w(l,()=>F(e.subItems()),null),I(r=>{const i=e.href,m=o.scrollOffset||0,g=e.href,T=e.title;return i!==r._v$&&L(n,"href",r._v$=i),m!==r._v$2&&L(n,"data-scroll-offset",r._v$2=m),g!==r._v$3&&L(n,"data-href",r._v$3=g),T!==r._v$4&&L(n,"title",r._v$4=T),r},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),l})()}):null;return(()=>{const t=ne(),e=t.firstChild,l=e.firstChild,n=l.firstChild,r=n.firstChild;return z(n,"cm-anchor-ink "+(D?"cm-anchor-show":"")),w(l,()=>F(s.links),null),I(i=>{const m=$(),g=`${s.inkTop}px`,T=`${s.inkHeight}px`;return i._v$5=B(t,m,i._v$5),g!==i._v$6&&((i._v$6=g)!=null?r.style.setProperty("top",g):r.style.removeProperty("top")),T!==i._v$7&&((i._v$7=T)!=null?r.style.setProperty("height",T):r.style.removeProperty("height")),i},{_v$5:void 0,_v$6:void 0,_v$7:void 0}),t})()}oe.Link=ee;G(["click"]);export{oe as A,se as C,Z as s};
